<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="HandheldFriendly" content="true" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>Authorization</title>
  <script src="js/askAuthorization.js" type="text/javascript"></script>
  <link rel="stylesheet" type="text/css" href="css/default.css">
</head>

<body>
  <div id="wrapper">
      <div id="container">
        <div id="userInfo">
            Logged in as <strong>{{ resourceOwnerId|e }}</strong>
        </div>
        <div class="authorizeMessage">
            <h2>{{ clientName|e }}</h2>
            <div class="clientDomain">on <strong>{{ clientDomain|e }}</strong></div>
            <div class="clientPermissions">wants your permission to access
                <ul>
                  {% for scope in scopes %}
                    <li>{{ scope|e }}</li>
                    <input type="hidden" name="scope[]" value="{{ scope|e }}">
                  {% endfor %}
              </ul>
            </div>
        </div> <!-- /authorizeMessage -->

          {% if not sslEnabled %}
            <div class="warnBox">
            <strong>INSECURE</strong> connection to this service, SSL or TLS <strong>MUST</strong> be used!
            {% if contactEmail %}
                Please <a href="mailto:{{ contactEmail|e }}">inform</a> the application provider.
            {% endif %}
            </div>
          {% endif %}

        <form method="post" action="">
          <table id="detailsTable">
            <tr><th>Client ID</th><td>{{ clientId|e }}</td></tr>
            <tr><th>Description</th><td><span>{{ clientDescription|e }}</span></td></tr>
            <tr><th>Redirect URI</th><td><tt>{{ redirectUri|e }}</tt></td></tr>
            <tr><th>Scope</th>
            <td>
            {% if scopes|length == 0 %}
              <em>None</em>
            {% else %}
              <ul>
                  {% for scope in scopes %}
                    <li>{{ scope|e }}</li>
                    <input type="hidden" name="scope[]" value="{{ scope|e }}">
                  {% endfor %}
              </ul>
            {% endif %}
            </td>
            </tr>
          </table>
          <button id="showDetails" type="button">Details</button>
          <input type="submit" class="formButton" name="approval" value="Approve">
          <input type="submit" class="formButton" name="approval" value="Reject">
        </form>
      </div><!-- /container -->
  </div><!-- /wrapper -->
</body>
</html>
